{% extends "common/templates/layout.njk" %}
{% from "components/back-link/macro.njk" import govukBackLink %}
{% from "components/table/macro.njk" import govukTable %}
{% from "components/inset-text/macro.njk" import govukInsetText %}
{% from "components/button/macro.njk" import govukButton %}

{% block pageTitle %}
  Check your details are correct
{% endblock %}

{% block content %}
  <main id="content" role="main">
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        {% set backLinkURL%}/setup/{{mandateExternalId}}{% endset %}
        {{
          govukBackLink({
            text: "Back",
            href: backLinkURL
          })
        }}
        {{
          govukTable({
            caption: "Check your details are correct",
            captionClasses: "govuk-heading-l",
            firstCellIsHeader: true,
            rows: [
              [
                {
                  text: "Name on the account:"
                },
                {
                  text: accountHolderName,
                  attributes: {
                    id: "account-holder-name"
                  }
                }
              ],
              [
                {
                  text: "Sort code:"
                },
                {
                  text: sortCode,
                  attributes: {
                    id: "sort-code"
                  }
                }
              ],
              [
                {
                  text: "Account number:"
                },
                {
                  text: accountNumber,
                  attributes: {
                    id: "account-number"
                  }
                }
              ]
            ]
          })
        }}

        {% if mandateType == 'ON_DEMAND' %}
        {% set insetHTML %}
          <p class="govuk-body govuk-!-margin-top-6 govuk-!-margin-bottom-6">We will notify you by email 3 days before each future payment.</p>
        {% endset %}
        {{
          govukInsetText({
            html: insetHTML
          })
        }}
        {% endif %}
        <form
          class="form"
          method="POST"
          action="/confirmation/{{mandateExternalId}}"
          data-virtual-pageview="/success/{{mandateExternalId}}"
          data-parameters="dimension2:{{gatewayAccount.type}} dimension3:GoCardless metric1:{{amount}}"
        >
          <input id="csrf" name="csrfToken" type="hidden" value="{{csrf}}" />
          {% set buttonText%}
            Confirm {{ "payment" if mandateType == 'ONE_OFF' else "mandate" }}
          {% endset%}
          {{
            govukButton({
              text: buttonText,
              attributes: {
                id: "submit-direct-debit"
              }
            })
          }}

          <p class="govuk-body">
            <a class="govuk-link govuk-link--no-visited-state cancel-link" href="/cancel/{{mandateExternalId}}">Cancel {{ "payment" if mandateType == 'ONE_OFF' else "mandate" }}</a>
          </p>
        </form>
      </div>
      {% if mandateType == 'ONE_OFF' %}
      <div class="govuk-grid-column-one-third payment-summary-wrap">
        <aside class="payment-summary">
          <h2 class="govuk-heading-m">Payment summary</h2>
          <p class="govuk-body govuk-!-font-weight-bold" id="payment-description">{{description}}</p>
          <p class="govuk-body govuk-!-margin-bottom-0">Total amount: <span class="amount govuk-!-font-size-36 govuk-!-font-weight-bold" id="amount">Â£{{amount}}</span>
        </aside>
      </div>
      {% endif %}
    </div>
    {% block dd_guarantee_anchor %}
      {% include "app/direct-debit-guarantee/anchor.njk" %}
    {% endblock %}
    </div>
  </main>
{% endblock %}
